<style>
    .popup {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
    }

    .popup-content {
        background-color: #fefefe;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
    }

    .close-popup {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
    }

    .close-popup:hover {
        color: black;
        text-decoration: none;
        cursor: pointer;
}
</style>








<a href="#" class="open-popup" data-task-url="{% url 'core:feedback' %}">Обратная связь</a>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


  <div id="popup" class="popup">
    <div class="popup-content">
        <span class="close-popup">&times;</span>
        <div id="popup-content-placeholder"></div>
    </div>
</div>
<script>
 // Получаем ссылки, которые открывают попап
    const openPopupLinks = document.querySelectorAll('.open-popup');

    // Получаем элементы попапа и его контента, а также кнопку закрытия
    const popup = document.getElementById('popup');
    const popupContent = document.getElementById('popup-content-placeholder');
    const closePopupButton = document.querySelector('.close-popup');

    // Добавляем обработчики событий для каждой ссылки, открывающей попап
    openPopupLinks.forEach(link => {
        link.addEventListener('click', function (event) {
            event.preventDefault(); // Отменяем стандартное действие ссылки
            const taskUrl = this.getAttribute('data-task-url'); // Получаем URL задания

            // Загружаем содержимое задания с сервера и отображаем в попапе
            fetch(taskUrl)
                .then(response => response.text())
                .then(html => {
                    popupContent.innerHTML = html; // Вставляем полученное HTML-содержимое
                    popup.style.display = 'block'; // Открываем попап
                });
        });
    });
    
    // Обработчик клика на кнопку закрытия попапа
    closePopupButton.addEventListener('click', function () {
        popup.style.display = 'none'; // Закрываем попап
        popupContent.innerHTML = ''; // Очищаем содержимое попапа
    });


    // Обработчик отправки формы
    popupContent.addEventListener('submit', function (event) {
        event.preventDefault(); // Отменяем стандартное действие формы

        const form = event.target;
        const formData = new FormData(form);

        fetch(form.action, {
            method: 'POST',
            body: formData,
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // После успешной отправки формы показываем сообщение и закрываем попап
                const successMessage = document.createElement('p');
                successMessage.textContent = 'Сообщение в поддержку отправлено!';
                popupContent.appendChild(successMessage);

                setTimeout(function () {
                    popup.style.display = 'none';
                    popupContent.innerHTML = ''; // Очищаем содержимое попапа
                    window.location.reload(); // Перенаправляем на текущую страницу
                }, 2000); // Ждем 2 секунды перед закрытием попапа
            } else {
                // Если есть ошибки формы, показываем их
            }
        });
    });
</script>






<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/codemirror.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/mode/python/python.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/theme/monokai.min.css">
<style>
    .CodeMirror {
    font-size: 16px; 
    width: 1000px;
    height: 500px;
  }

  .progress-bar {
  width: 500px;
  height: 20px;
  background-color: #ccc;
  border-radius: 10px;
  margin-top: 5px;
}

.progress {
  height: 100%;
  background-color: #4caf50;
  border-radius: 10px;
  transition: width 0.3s ease-in-out;
}
  </style>